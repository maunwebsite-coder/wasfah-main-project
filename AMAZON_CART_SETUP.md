# إعداد وظيفة Amazon Cart

## نظرة عامة
تم إضافة وظيفة "متابعة الشراء على Amazon" التي تسمح للمستخدمين بإضافة منتجات متعددة إلى سلة التسوق في Amazon مباشرة من موقعك.

## المميزات
- ✅ إضافة منتجات متعددة إلى سلة Amazon في مرة واحدة
- ✅ استخراج ASIN تلقائياً من روابط Amazon
- ✅ دعم جميع تنسيقات روابط Amazon
- ✅ رسائل تشخيصية للمطورين
- ✅ واجهة مستخدم محسنة

## الإعدادات المطلوبة

### 1. متغيرات البيئة
أضف هذه المتغيرات إلى ملف `.env`:

```env
# Amazon Affiliate Settings
AMAZON_AFFILIATE_TAG=wasfah-21
AMAZON_MARKETPLACE=sa
```

### 2. إعدادات التكوين
تم إضافة إعدادات Amazon في `config/services.php`:

```php
'amazon' => [
    'affiliate_tag' => env('AMAZON_AFFILIATE_TAG', 'wasfah-21'),
    'marketplace' => env('AMAZON_MARKETPLACE', 'sa'),
],
```

## كيفية الاستخدام

### 1. في صفحة السلة
- اضغط على "متابعة الشراء على Amazon" لإضافة جميع المنتجات إلى سلة Amazon
- اضغط على "اختبار Amazon Cart" لاختبار الوظيفة ومعرفة تفاصيل المنتجات

### 2. في صفحة الأدوات
- أضف منتجات إلى السلة
- اضغط على "متابعة الشراء على Amazon" في أعلى الصفحة

## كيفية عمل الوظيفة

### 1. استخراج ASIN
الوظيفة تستخرج ASIN (Amazon Standard Identification Number) من روابط Amazon المختلفة:

```php
// تنسيقات مدعومة:
// https://www.amazon.sa/dp/B08N5WRWNW
// https://www.amazon.sa/product/B08N5WRWNW
// https://www.amazon.sa/gp/product/B08N5WRWNW
// https://www.amazon.sa/exec/obidos/ASIN/B08N5WRWNW
```

### 2. إنشاء رابط Amazon Cart
```php
// مثال على الرابط المُنشأ:
https://www.amazon.sa/gp/aws/cart/add.html?AssociateTag=wasfah-21&ASIN.1=B08N5WRWNW&Quantity.1=2&ASIN.2=B07XYZ1234&Quantity.2=1
```

## اختبار الوظيفة

### 1. اختبار سريع
1. أضف منتجات إلى السلة
2. اذهب إلى صفحة السلة
3. اضغط على "اختبار Amazon Cart"
4. راجع النتائج في نافذة التنبيه

### 2. اختبار شامل
1. تأكد من أن روابط Amazon صحيحة
2. تأكد من أن ASIN يتم استخراجه بشكل صحيح
3. تأكد من أن الرابط النهائي يعمل

## استكشاف الأخطاء

### 1. فحص السجلات
```bash
tail -f storage/logs/laravel.log | grep "Amazon Cart"
```

### 2. مشاكل شائعة
- **ASIN غير موجود**: تأكد من صحة رابط Amazon
- **رابط لا يعمل**: تأكد من معرف الشريك (Affiliate Tag)
- **منتجات لا تظهر**: تأكد من أن المنتجات لها روابط Amazon صحيحة

## ملاحظات مهمة

### 1. قيود Amazon
- الحد الأقصى: 10 منتجات في رابط واحد
- صلاحية السلة: 90 يوم
- يجب أن تكون المنتجات متوفرة في نفس السوق

### 2. متطلبات برنامج الشركاء
- يجب أن تكون مسجلاً في برنامج شركاء Amazon
- يجب استخدام معرف الشريك الصحيح
- يجب الامتثال لسياسات Amazon

## الدعم

إذا واجهت أي مشاكل:
1. تحقق من السجلات
2. استخدم زر "اختبار Amazon Cart"
3. تأكد من إعدادات البيئة
4. راجع وثائق Amazon Associates

---

**تم التطوير بواسطة:** فريق موقع وصفة  
**تاريخ التحديث:** {{ date('Y-m-d') }}
